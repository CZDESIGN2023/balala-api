# 前言說明
- 框架使用go-kratos, 所以目錄結構與組件用法基本都是跟著框架設計
- 為了節省資料傳輸量所以使用protobuf協議, 因此前後端共用的資料都是先定義.proto檔(例如:API介面回傳資料, table字段定義), 
  再打開終端機輸入指令(make api)生成相關的code

# 目錄結構說明
## api
- [chat] 聊天會話
- [chat_user] 聊天用戶
- [comm] 共用模塊(錯誤碼設定, 需再到i18n目錄設定文字訊息)
- [login] 登入
- [message] 聊天信息
    ```
    api內的.proto檔有修改的話, 需執行make api重新生成code(或執行make all)
    ```

## cmd
- [go-cs] 主程式啟動目錄
- [generate_apply_update_block] table相關產檔程式: 由types.proto產生gorm的table字段定義及字段操作更新相關程式
- [dart-proto-generator] dart產檔: 產出的檔案複製到flutter專案使用 (放到data-center/lib/內對應位置)

## configs
- [config.yaml] 參數設定檔

## i18n
- [files] 多國語系檔, 和api/comm/errors.proto配合使用

## internal
- [bean/types.proto] table字段定義 (其他types_的檔案都是 cmd/generate_apply_update_block執行產生的)
- [bean/request.proto] 長連接模擬短連接的傳接格式定義 
    ```
    有修改的話, 需執行make config, 或懶得思考就執行make all
    如果是修改types.proto的table字段, 執行make all就好(已包含執行cmd/generate_apply_update_block)
    ```

- [data] 數據層: table存取相關的code寫在這, 目前用gorm 
- [biz] 業務組裝層: 這邊建立的func可視需求組合多個data
- [service] 服務層(api的實作層): 這邊建立的func可視需求組合多個biz
    ```
    前端請求資料流: api -> service -> biz -> data
    api、service、biz、data內都有相同命名的.go檔, debug時可直接從service開始追
    例如api/chat.go, 可以找到service/chat.go
    ```

- [conf] 參數設定: conf.proto與configs/config.yaml結構對應
    ```
    有調整configs/config.yaml時, 應同步調整conf.proto, 再make config生成程式內能直接使用的conf.pb.go
    ```
  
- [server] 主程式內的子服務, 例如http、websock/server ...

- [utils] 共用函示

- [test] test case